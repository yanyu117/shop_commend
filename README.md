## 商品推荐

它是利⽤电⼦商务⽹站向客户提供商品信息和建议，帮助⽤户决定应该购买什么产品，模拟销售⼈员帮助客户完成 购买过程。

使用技术：MySQL、Hadoop Map Reduce、Flume、Kauka、Zookeeper、SSM。

推荐系统有3个重要的模块：

1. ⽤户建模模块
2. 推荐对象建模模块 
3. 推荐算法模块

### 推荐流程（mapreduce）

1. #### 获取⽤户对于商品的偏好值

   ⽤户对于商品的偏好值=购买40%+添加收藏10%+添加购物⻋15%+浏览商品5%+⽣成订单30%，每⼀个⾏为可以产⽣多次所以偏好 值可以⼤于1

2. #### 获取商品的偏好矩阵

   将第⼀步的数据进行切割，将商品id整理成key，然后⽤户--偏好值整理成value，在reduce中将每⼀组value进行拼接

3. #### 得到商品的共现关系

   该步骤计算是根据第⼀步的计算结果进⾏计算的，map这⾥不需要关注⽤户的偏好值只需要关注⽤户和商品的关系，map阶段将⽤户id 作为key，商品id 作为value；在reduce阶段统计同⼀个⽤户偏好商品的共现次数，即该⽤户偏好的所有商品做笛卡尔积；因为reduce阶段我们获取到的 values 在遍历的时候是不可逆的，不⽅便我们统计共现次数，所以可以先将 values 中的数据放置到⼀个新的容器然后使⽤这个临时容器进⾏共现次数的统计。统计共现次数即这个容器中的数据⾃⼰与⾃⼰做笛卡尔积；

4. #### 统计商品的共现次数

   该步骤根据第三步骤进⾏计算；map阶段将 第三步骤产⽣的结果进⾏拼接产⽣新的key；因为上⼀步做笛卡尔积就会产⽣⾃⼰与⾃⼰组合的情况，这种数据对我们推荐并没有太⼤的实际意义所以选择剔除；然后出现次数1作为value进⾏输出；reduce阶段只需要将出现次数进⾏累加即可。

5. #### 获取商品共现矩阵

   该步骤是根据第四步骤进⾏计算的；这⾥我们要得到⼀个对于某⼀个商品共现的所有商品以及共现次数构成的矩 阵；所以在map阶段我们对数据进⾏切割，以 商品id 做为key， 共现商品的id：共现次数做为value进⾏输出； reduce阶段对于⼀个商品的共现商品和共现次数产⽣的集合进⾏遍历然后将数据拼接；

6. #### 计算出推荐矩阵

   物品相似度*⽤户偏好值=推荐向量

   该步骤的计算要基于第⼆步和第五步的计算结果；在map阶段将数据分割 ， 商品id 作为key， ⽤户偏好值矩阵和 商品相似矩阵分别作为不同Map的输出；因为在⽤户偏好值计算的时候我们拼接⽤户和偏好值时使⽤-⽽计算商品相似度的时候我们拼接商品id和相似度的时候使⽤的是:,因此在reduce阶段我们可以以此作为区分数据的标准 从⽽将不同的数据放置到不同的容器然后进⾏运算；然后将 ⽤户:商品作为key， 推荐值作为value进⾏输出；

7. #### 统计商品对于⽤户的推荐值

   该步骤的计算是根据第六步骤进⾏运算的；只需要将上⼀步骤计算结果中 对于⼀个⽤户推荐的同⼀个商品的推荐 值进⾏累加即可

8. #### 剔除推荐商品中已经购买的商品

   该步骤计算根据第七步骤以及⽤户⾏为数据⽂件；因为两个⽂件的数据特征并不⼀致因此需要使 ⽤ MultipleInputs 为不同的map指定不通的输⼊⽂件；对于读取⽤户⾏为数据的map⽽⾔只需要统计⽤户的购 买⾏为，因为将 ⽤户id：商品id 作为key， ⽤户⾏为作为value输出，对于读取第七步骤的map⽽⾔将 品id 作为key， ⽤户id：商 推荐值作为value输出；reduce阶段只需关注values中是否包含⽤户⾏为 如果有⽤户⾏为则不进⾏ 输出

9. #### 将对于⽤户的推荐数据保存到数据库

   该步骤使⽤的数据为第⼋步骤的计算结果；将数据落地到数据因此需要创建实体类并且序列化；然后配置好数据库 的连接信息指定好要保存的表要对应的每⼀个字段；

10. #### ⼯作流整合所有的job

    因为在实际项⽬开发中，没有办法去预料每⼀步job的结束时间也就没有办法⽴即开始下⼀job的计算，因此使⽤ ⼯作流将所有的job进⾏管理；

###shop.conf 是flume程序

###shop文件是 推荐算法的实现

###pop.xml 文件引入依赖，解决hadoop没有mysql的jar包而报错的问题






